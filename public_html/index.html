<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8" />
  <title>Its a GNU EWE</title>
  <meta name="viewport" content="width=device-width,initial-scale=1.0" />
  <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
  <style>
    :root {
      --bg-main: #0d1117;
      --bg-nav: #161b22;
      --border-nav: #21262d;
      --text-main: #c9d1d9;
      --text-link: #58a6ff;
      --text-muted: #8b949e;
      --bg-active: #21262d;
      --radius-main: 5px;
      --font-main: Arial, sans-serif;
      /* Stroke width + transition */
      --icon-stroke-width: 1.6;
      --icon-transition: 120ms;

      /* Color mappings (derive from existing site variables) */
      --icon-color-base: var(--text-main);
      --icon-color-accent: var(--text-link);
      --icon-color-muted: var(--text-muted);
      --icon-color-danger: #ff4d4f;
      --icon-color-warn: #e0a210;
      --icon-color-success: #31c48d;
    }

    html,
    body {
      margin: 0;
      padding: 0;
      width: 100%;
      min-height: 100vh;
      box-sizing: border-box;
    }

    *,
    *:before,
    *:after {
      box-sizing: inherit;
    }

    body {
      font-family: var(--font-main);
      background: var(--bg-main);
      color: var(--text-main);
      overflow-x: hidden;
    }

    nav#topnav {
      background: var(--bg-nav);
      border-bottom: 1px solid var(--border-nav);
      width: 100%;
      position: relative;
      z-index: 10;
    }

    .nav-inner {
      display: flex;
      align-items: center;
      gap: 0.75rem;
      padding: 0.5em 1.1em;
      flex-wrap: wrap;
    }

    .nav-title {
      font-weight: bold;
      font-size: 1.12em;
      white-space: nowrap;
    }

    #filter-container {
      display: flex;
      align-items: center;
      flex: 1 1 260px;
      max-width: 340px;
      min-width: 180px;
      position: relative;
    }

    #tag-filter {
      background: var(--bg-main);
      border: 1px solid var(--border-nav);
      color: var(--text-main);
      font-size: 1em;
      border-radius: var(--radius-main);
      padding: 0.5em 1em;
      width: 100%;
    }

    ul#nav-list {
      display: flex;
      flex: 1 1 auto;
      list-style: none;
      margin: 0;
      padding: 0;
      gap: 0.5em;
      flex-wrap: wrap;
    }

    ul#nav-list a {
      display: block;
      color: var(--text-link);
      text-decoration: none;
      padding: 0.55em 1.0em;
      font-size: 0.96em;
      border-radius: 4px;
      transition: background 0.15s, color 0.15s;
      white-space: nowrap;
    }

    ul#nav-list a.active,
    ul#nav-list a:hover {
      background: var(--bg-active);
      color: var(--text-main);
    }

    .nav-actions {
      display: flex;
      align-items: center;
      gap: 0.35em;
      margin-left: auto;
    }

    #menu-toggle,
    #open-theme-dashboard {
      background: none;
      border: 1px solid var(--border-nav);
      color: var(--text-link);
      cursor: pointer;
      font-size: 1.05em;
      padding: 0.35em 0.7em;
      border-radius: var(--radius-main);
      line-height: 1;
    }

    #menu-toggle {
      font-size: 1.5em;
      border: none;
    }

    #content {
      padding: 32px;
      background: var(--bg-main);
    }

    @media (max-width:600px) {
      #filter-container {
        display: none;
      }

      #menu-toggle {
        display: block;
      }

      ul#nav-list {
        display: none;
        flex-direction: column;
        width: 100%;
        background: var(--bg-nav);
        border-top: 1px solid var(--border-nav);
        padding: 0.4em 0.4em 0.6em;
      }

      ul#nav-list.show {
        display: flex;
      }

      #mobile-filter {
        display: block;
        position: absolute;
        left: 0;
        top: 100%;
        width: 100vw;
        background: var(--bg-nav);
        border-bottom: 1px solid var(--border-nav);
        padding: 0.5em 1.1em;
      }

      #mobile-filter.hide {
        display: none;
      }

      #content {
        padding: 18px 6vw;
        font-size: 1.08em;
      }
    }

    @media (min-width:601px) {
      #menu-toggle {
        display: none;
      }

      #mobile-filter {
        display: none !important;
      }

      ul#nav-list {
        display: flex !important;
        position: static;
      }
    }

    h1,
    h2,
    h3,
    h4,
    h5,
    h6 {
      color: var(--text-main);
      margin-top: 1.2em;
      margin-bottom: 0.5em;
    }

    code,
    pre {
      color: var(--text-muted);
      background: var(--bg-nav);
      border-radius: 6px;
      padding: 2px 4px;
      font-size: 1em;
      word-break: break-all;
    }

    pre {
      padding: 12px;
      overflow-x: auto;
    }

    img {
      max-width: 100%;
      height: auto;
    }

    a {
      color: var(--text-link);
    }

    /* Theme Dashboard Panel */
    #theme-dashboard {
      position: fixed;
      top: 0;
      right: 0;
      width: 320px;
      max-width: 90vw;
      height: 100vh;
      background: var(--bg-nav);
      border-left: 1px solid var(--border-nav);
      transform: translateX(100%);
      transition: transform 0.25s ease;
      display: flex;
      flex-direction: column;
      z-index: 100;
    }

    #theme-dashboard.open {
      transform: translateX(0);
    }

    #theme-dashboard header {
      padding: 0.75em 1em;
      border-bottom: 1px solid var(--border-nav);
      font-weight: bold;
      font-size: 1.05em;
      position: relative;
    }

    #theme-dashboard button.close-dashboard {
      background: none;
      border: none;
      color: var(--text-link);
      font-size: 1.2em;
      cursor: pointer;
      position: absolute;
      top: 0.35em;
      right: 0.4em;
    }

    #theme-dashboard .themes-list {
      overflow-y: auto;
      padding: 0.75em 0.6em 1em;
      flex: 1;
      display: flex;
      flex-direction: column;
      gap: 0.5em;
    }

    .theme-item {
      border: 1px solid var(--border-nav);
      border-radius: 6px;
      padding: 0.55em 0.6em;
      display: flex;
      flex-direction: column;
      gap: 0.35em;
      background: var(--bg-main);
    }

    .theme-item-header {
      display: flex;
      align-items: center;
      justify-content: space-between;
      gap: 0.5em;
    }

    .theme-item button.apply-theme {
      background: none;
      border: 1px solid var(--border-nav);
      color: var(--text-link);
      cursor: pointer;
      font-size: 0.85em;
      padding: 0.3em 0.6em;
      border-radius: 4px;
    }

    .theme-item.active {
      outline: 2px solid var(--text-link);
    }

    /* =========================================
   ICON SYSTEM (theme-aware)
   ========================================= */

    /* Inherit site palette */
    :root {
      /* Stroke width + transition */
      --icon-stroke-width: 1.6;
      --icon-transition: 120ms;

      /* Color mappings (derive from existing site variables) */
      --icon-color-base: var(--text-main);
      --icon-color-accent: var(--text-link);
      --icon-color-muted: var(--text-muted);
      --icon-color-danger: #ff4d4f;
      --icon-color-warn: #e0a210;
      --icon-color-success: #31c48d;
    }

    /* Optional: adjust for a bright theme body.swatch-bright (if you use that class) */
    body.swatch-bright {
      /* These will automatically cascade to icons */
      /* Example overrides only if needed:
  --icon-color-danger: #d92e32;
  --icon-color-warn: #b98000;
  --icon-color-success: #188b58;
  */
    }

    .icon {
      /* Sizing defaults to 1em so it can live inline with text unless a size class is added */
      width: 1em;
      height: 1em;
      display: inline-block;
      vertical-align: middle;
      flex-shrink: 0;

      /* Theme-colors (stroke mode default) */
      color: var(--icon-color-base);
      stroke: currentColor;
      stroke-width: var(--icon-stroke-width);
      stroke-linecap: round;
      stroke-linejoin: round;
      fill: none;

      vector-effect: non-scaling-stroke;
      transition: color var(--icon-transition),
        stroke var(--icon-transition),
        fill var(--icon-transition),
        transform var(--icon-transition),
        opacity var(--icon-transition);
    }

    /* Size classes (explicit pixel mapping).
   You requested:
   sm=16, md=32, lg=64, x2=128, x4=256.
   (Base un-classed might be inline 1em â‰ˆ 16px depending on font-size) */
    .icon-sm {
      width: 16px;
      height: 16px;
    }

    .icon-md {
      width: 32px;
      height: 32px;
    }

    .icon-lg {
      width: 64px;
      height: 64px;
    }

    .icon-x2 {
      width: 128px;
      height: 128px;
    }

    .icon-x4 {
      width: 256px;
      height: 256px;
    }

    /* (Optional) micro / extra if you later need them:
.icon-xs { width:12px; height:12px; }
.icon-xl { width:96px; height:96px; }
*/

    /* Stroke weight variants */
    .icon-thin {
      stroke-width: 1.2;
    }

    .icon-bold {
      stroke-width: 2;
    }

    /* Switch to solid fill mode */
    .icon-fill {
      fill: currentColor;
      stroke: none;
    }

    /* Force outline even if a parent adds a fill class */
    .icon-outline {
      fill: none !important;
      stroke: currentColor !important;
      stroke-width: var(--icon-stroke-width) !important;
    }

    /* Color utility variants (override currentColor) */
    .icon-accent {
      color: var(--icon-color-accent);
    }

    .icon-muted {
      color: var(--icon-color-muted);
    }

    .icon-danger {
      color: var(--icon-color-danger);
    }

    .icon-warn {
      color: var(--icon-color-warn);
    }

    .icon-success {
      color: var(--icon-color-success);
    }

    /* Hover helpers (add to wrapper or icon) */
    .icon-hover-scale:hover {
      transform: scale(1.12);
    }

    .icon-pressable {
      transition: transform 120ms;
    }

    .icon-pressable:active {
      transform: translateY(1px) scale(.96);
    }

    /* Animations */
    .icon-rotate {
      animation: icon-rotate 1s linear infinite;
    }

    @keyframes icon-rotate {
      to {
        transform: rotate(360deg);
      }
    }

    .icon-pulse {
      animation: icon-pulse 1.2s ease-in-out infinite;
    }

    @keyframes icon-pulse {

      0%,
      100% {
        opacity: 1;
      }

      50% {
        opacity: .35;
      }
    }

    /* Disabled state */
    .icon-disabled,
    [disabled] .icon {
      opacity: .4;
      pointer-events: none;
    }

    /* Icon button pattern */
    .icon-btn {
      display: inline-flex;
      align-items: center;
      gap: 0.5em;
      padding: 0.42em 0.75em;
      background: transparent;
      color: inherit;
      border: 1px solid currentColor;
      border-radius: 6px;
      cursor: pointer;
      font: inherit;
      line-height: 1;
      transition: background 140ms, color 140ms, border-color 140ms;
    }

    .icon-btn:hover {
      color: var(--icon-color-accent);
      border-color: var(--icon-color-accent);
    }

    .icon-btn:focus-visible {
      outline: 2px solid var(--icon-color-accent);
      outline-offset: 2px;
    }

    /* If you want icon inside .btn to space nicely */
    .btn .icon:first-child {
      margin-right: .45em;
    }

    .btn .icon:last-child:not(:only-child) {
      margin-left: .45em;
    }


    .site-footer {
      background: var(--bg-nav);
      color: var(--text);
      padding: 2rem 1rem;
      font-size: 0.9em;
      box-shadow: 0 -2px 6px var(--shadow);
    }



    #footer-links {
      display: flex;
      gap: 2rem;
      flex-wrap: wrap;
    }

    #footer-links .footer-links {
      flex: 1 1 200px;
    }

    #footer-links h4 {
      margin-bottom: 0.5rem;
      font-size: 1em;
    }

    #footer-links ul {
      list-style: none;
      padding: 0;
      margin: 0;
    }

    #footer-links li {
      margin-bottom: 0.3rem;
    }

    #footer-links a {
      color: var(--ui-accent);
      text-decoration: none;
      transition: color 0.2s;
    }

    #footer-links a:hover {
      color: var(--ui-accent-hover);
    }

    #footer-legal {
      width: 100%;
      font-size: 8px;
      font-family: 'Courier New', Courier, monospace;
      text-align: left;
      margin: 0 auto;
    }

    #footer-about {
      display: flex;
      justify-content: space-between;
      width: 100%;
    }


    #dynamic-theme {}
  </style>
</head>

<body>

  <nav id="topnav" aria-label="Documentation navigation">
    <div class="nav-inner">
      <span class="nav-title">
        <a href="/" style="color:inherit; text-decoration:none;">
          <img src="images/ewe_hat.svg" alt="Logo" width="64" />
        </a>
      </span>
      <div id="filter-container">
        <input id="tag-filter" type="text" placeholder="Filter by tag or keyword" autocomplete="off" />
      </div>
      <ul id="nav-list" aria-label="Sections"></ul>
      <div class="nav-actions">
        <!-- AFTER -->
        <button id="open-theme-dashboard" type="button" aria-label="Open theme dashboard">
          <svg class="icon icon-md">
            <use href="images/icons.svg#i-color"></use>
          </svg>
        </button>
        <button id="menu-toggle" aria-label="Show navigation menu" aria-controls="nav-list" aria-expanded="false">
          <svg class="icon icon-md">
            <use href="images/icons.svg#i-menu"></use>
          </svg>
        </button>
      </div>
    </div>
    <div id="mobile-filter" class="hide">
      <input id="tag-filter-mobile" type="text" placeholder="Filter by tag or keyword" autocomplete="off"
        style="width:100%; border:1px solid var(--border-nav); font-size:1em; border-radius:5px; padding:0.5em 1em; background:var(--bg-main); color:var(--text-main);" />
    </div>
  </nav>

  <aside id="theme-dashboard" aria-label="Theme dashboard" aria-hidden="true">
    <header>
      Themes
      <button class="close-dashboard" aria-label="Close themes panel">âœ•</button>
    </header>
    <div class="themes-list" id="themes-list"></div>
  </aside>

  <div id="content">Loading...</div>

  <footer id="site-footer" class="site-footer" role="contentinfo">
    <div id="footer-links" class="footer-loading">Loading linksâ€¦</div>
    <div id="footer-about" class="footer-loading">Loading aboutâ€¦</div>
    <div id="footer-legal" class="footer-loading">Loading legalâ€¦</div>
  </footer>
  <script src="/js/footer.js"></script>
  <script>
    /* Manifest path */
    const THEME_MANIFEST_URL = 'json/themes.json';

    /* Navigation / markdown logic */
    const navLinks = [
      { "label": "Home", "file": "docs/README.md", "tags": ["nav", "config", "guide", "home"] },
      { "label": "About", "file": "https://raw.githubusercontent.com/Tearran/Tearran/refs/heads/main/README.md", "tags": ["nav", "tearran", "intro", "overview"] },
      { "label": "Bash", "file": "https://raw.githubusercontent.com/rstacruz/cheatsheets/refs/heads/master/bash.md", "tags": ["nav", "tearran", "intro", "overview"] }
    ];

    const localLinksJson = "json/navlinks.json";
    let allLinks = null;
    let lastFilter = "";

    /* Helpers */
    function getNavTaggedLinks() {
      const map = new Map();
      function addIfNav(list) {
        list.forEach(item => {
          if (item.tags && item.tags.some(t => t.toLowerCase() === "nav")) map.set(item.file, item);
        });
      }
      addIfNav(navLinks);
      if (Array.isArray(allLinks)) addIfNav(allLinks);
      return [...map.values()];
    }

    function getAllLinksUnique() {
      const map = new Map();
      navLinks.forEach(link => map.set(link.file, link));
      if (Array.isArray(allLinks)) {
        allLinks.forEach(link => {
          if (!map.has(link.file)) map.set(link.file, link);
        });
      }
      return [...map.values()];
    }

    function renderMenuLinks(filter = "", initialLoad = false) {
      const navList = document.getElementById('nav-list');
      navList.innerHTML = '';
      const f = filter.trim().toLowerCase();
      let linksToShow;
      if (initialLoad && !f) {
        linksToShow = getNavTaggedLinks();
      } else if (f) {
        linksToShow = getAllLinksUnique().filter(item =>
          item.label.toLowerCase().includes(f) ||
          (item.tags && item.tags.some(tag => tag.toLowerCase().includes(f)))
        );
      } else {
        linksToShow = getNavTaggedLinks();
      }
      let shown = 0;
      linksToShow.forEach(item => {
        const li = document.createElement('li');
        const a = document.createElement('a');
        a.textContent = item.label;
        a.href = "#";
        a.dataset.md = item.file;
        if (shown === 0) a.classList.add('active');
        li.appendChild(a);
        navList.appendChild(li);
        shown++;
      });
      if (shown === 0) {
        const li = document.createElement('li');
        li.innerHTML = '<span style="opacity:0.7;font-size:0.95em;padding:0.55em 1em;">No matches</span>';
        navList.appendChild(li);
      }
    }

    function loadMarkdown(filename) {
      fetch(filename)
        .then(r => { if (!r.ok) throw new Error("Not found"); return r.text(); })
        .then(text => {
          document.getElementById('content').innerHTML = marked.parse(text);
        })
        .catch(() => {
          document.getElementById('content').innerHTML = "<p>Could not load " + filename + ".</p>";
        });
    }

    function fetchExtraLinks(cb) {
      fetch(localLinksJson)
        .then(r => { if (!r.ok) throw new Error(); return r.json(); })
        .then(json => { allLinks = json; cb && cb(true); })
        .catch(() => { allLinks = []; cb && cb(false); });
    }

    /* Theme system */
    let themeManifest = [];
    let activeThemeId = null; // null = baseline

    function clearThemeClasses() {
      [...document.body.classList].forEach(c => {
        if (c.startsWith('theme-')) document.body.classList.remove(c);
      });
    }

    function applyRuntimeVars(varsObj) {
      let styleEl = document.getElementById('dynamic-theme');
      if (!styleEl) {
        styleEl = document.createElement('style');
        styleEl.id = 'dynamic-theme';
        document.head.appendChild(styleEl);
      }
      if (!varsObj) {
        styleEl.textContent = '';
        return;
      }
      const lines = Object.entries(varsObj).map(([k, v]) => `${k}: ${v};`);
      styleEl.textContent = `:root { ${lines.join(' ')} }`;
    }

    function applyTheme(id) {
      const item = themeManifest.find(t => t.id === id);
      applyRuntimeVars(null);
      clearThemeClasses();
      if (!item) {
        activeThemeId = null;
        markActiveCard();
        return;
      }
      if (item.class) {
        document.body.classList.add(item.class);
      }
      if (item.vars) {
        applyRuntimeVars(item.vars);
      }
      activeThemeId = id;
      markActiveCard();
      // Persistence (disabled):
      // localStorage.setItem('activeThemeId', id);
    }

    function markActiveCard() {
      document.querySelectorAll('.theme-item').forEach(div => {
        if (div.dataset.themeId === (activeThemeId || '')) div.classList.add('active');
        else div.classList.remove('active');
      });
    }

    function buildThemeCards() {
      const container = document.getElementById('themes-list');
      container.innerHTML = '';

      const baselineCard = document.createElement('div');
      baselineCard.className = 'theme-item';
      baselineCard.dataset.themeId = '';
      baselineCard.innerHTML = `
    <div class="theme-item-header">
      <strong>Baseline (Dark)</strong>
      <button class="apply-theme" type="button">Use</button>
    </div>
    <small>Default variables</small>
  `;
      baselineCard.querySelector('button.apply-theme')
        .addEventListener('click', () => applyTheme(null));
      container.appendChild(baselineCard);

      themeManifest.forEach(t => {
        const div = document.createElement('div');
        div.className = 'theme-item';
        div.dataset.themeId = t.id;
        const desc = t.description ? `<small>${t.description}</small>` : '';
        const group = t.group ? `<small style="opacity:0.6;">Group: ${t.group}</small>` : '';
        div.innerHTML = `
      <div class="theme-item-header">
        <strong>${t.label || t.id}</strong>
        <button class="apply-theme" type="button">Use</button>
      </div>
      ${desc}
      ${group}
    `;
        div.querySelector('button.apply-theme')
          .addEventListener('click', () => applyTheme(t.id));
        container.appendChild(div);
      });
      markActiveCard();
    }

    function loadThemeManifest() {
      return fetch(THEME_MANIFEST_URL)
        .then(r => {
          if (!r.ok) throw new Error('No theme manifest');
          return r.json();
        })
        .then(json => {
          themeManifest = Array.isArray(json) ? json : [];
          buildThemeCards();
        })
        .catch(() => {
          themeManifest = [];
          buildThemeCards();
        });
    }

    function setupThemeDashboard() {
      const openBtn = document.getElementById('open-theme-dashboard');
      const panel = document.getElementById('theme-dashboard');
      const closeBtn = panel.querySelector('.close-dashboard');

      function open() {
        panel.classList.add('open');
        panel.setAttribute('aria-hidden', 'false');
      }
      function close() {
        panel.classList.remove('open');
        panel.setAttribute('aria-hidden', 'true');
      }

      openBtn.addEventListener('click', () => {
        if (panel.classList.contains('open')) close(); else open();
      });
      closeBtn.addEventListener('click', close);

      document.addEventListener('keydown', e => {
        if (e.key === 'Escape' && panel.classList.contains('open')) close();
      });
    }

    /* Init */
    document.addEventListener("DOMContentLoaded", function () {
      fetchExtraLinks(() => {
        renderMenuLinks("", true);

        const navList = document.getElementById('nav-list');
        const menuToggle = document.getElementById('menu-toggle');
        const tagFilter = document.getElementById('tag-filter');
        const tagFilterMobile = document.getElementById('tag-filter-mobile');
        const mobileFilter = document.getElementById('mobile-filter');

        function attachNavHandlers() {
          const navLinksEls = navList.querySelectorAll("a");
          function setActive(link) {
            navLinksEls.forEach(l => l.classList.remove("active"));
            if (link) link.classList.add("active");
          }
          navLinksEls.forEach(link => {
            link.addEventListener("click", function (e) {
              e.preventDefault();
              setActive(this);
              loadMarkdown(this.dataset.md);
              if (window.innerWidth <= 600 && navList.classList.contains("show")) {
                navList.classList.remove("show");
                menuToggle.setAttribute("aria-expanded", "false");
              }
            });
          });
        }

        attachNavHandlers();

        tagFilter.addEventListener("input", function () {
          lastFilter = this.value;
          if (tagFilterMobile) tagFilterMobile.value = lastFilter;
          renderMenuLinks(lastFilter, false);
          attachNavHandlers();
        });

        if (tagFilterMobile) {
          tagFilterMobile.addEventListener("input", function () {
            lastFilter = this.value;
            if (tagFilter) tagFilter.value = lastFilter;
            renderMenuLinks(lastFilter, false);
            attachNavHandlers();
          });
        }

        const firstLink = navList.querySelector("a");
        if (firstLink) loadMarkdown(firstLink.dataset.md);

        if (menuToggle) {
          menuToggle.addEventListener("click", function () {
            const expanded = navList.classList.toggle("show");
            menuToggle.setAttribute("aria-expanded", expanded);
            if (mobileFilter) {
              if (expanded) mobileFilter.classList.remove("hide");
              else mobileFilter.classList.add("hide");
            }
          });
        }

        window.addEventListener('resize', () => {
          if (window.innerWidth > 600 && mobileFilter) {
            mobileFilter.classList.add("hide");
            navList.classList.remove("show");
            menuToggle.setAttribute("aria-expanded", "false");
          }
        });

        setupThemeDashboard();
        loadThemeManifest();
        // Optional: reapply stored theme (if persistence later):
        // const saved = localStorage.getItem('activeThemeId'); if(saved) applyTheme(saved);
      });
    });
  </script>
</body>

</html>