<!DOCTYPE html>
<html lang="en">

<head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <title>SVG Icon Manager</title>
        <style>
                body {
                        margin: 0;
                        font-family: sans-serif;
                        background: #1e1e1e;
                        color: #ddd;
                }

                .toolbar {
                        background: #2d2d2d;
                        padding: 0.5rem;
                        display: flex;
                        gap: 0.5rem;
                        border-bottom: 1px solid #000;
                }

                .toolbar button {
                        padding: 0.4rem 0.8rem;
                        border: none;
                        border-radius: 4px;
                        background: #007acc;
                        color: white;
                        cursor: pointer;
                }

                .toolbar button:hover {
                        background: #005fa3;
                }

                main {
                        display: flex;
                        flex-wrap: wrap;
                        padding: 8px;
                        overflow: auto;
                        height: auto;
                }

                .icon-item {
                        display: flex;
                        flex-direction: column;
                        align-items: center;
                        width: 64px;
                        margin: 4px;
                        padding: 4px;
                        cursor: pointer;
                        border: 1px solid #555;
                        border-radius: 4px;
                        transition: all 0.2s ease;
                }

                .icon-item:hover {
                        background: #333;
                        border-color: #007acc;
                }

                svg {
                        width: 32px;
                        height: 32px;
                        fill: none;
                        stroke: currentColor;
                }

                .icon-name {
                        font-size: 0.75rem;
                        margin-top: 4px;
                        text-align: center;
                        word-break: break-word;
                }

                .editor-panel {
                        position: fixed;
                        top: 50px;
                        right: 0;
                        width: 400px;
                        height: calc(100vh - 50px);
                        background: #111;
                        border-left: 2px solid #000;
                        display: flex;
                        flex-direction: column;
                        padding: 8px;
                }

                .editor-panel textarea {
                        flex: 1;
                        width: 100%;
                        background: #1e1e1e;
                        color: #fff;
                        border: none;
                        resize: none;
                        padding: 4px;
                        font-family: monospace;
                        margin-bottom: 4px;
                }
        </style>
</head>

<body>

        <div class="toolbar">
                <button onclick="addIcon()">+ Add Icon</button>
                <button onclick="downloadAll()">Download All</button>
                <input type="file" id="svgFileInput" accept=".svg" style="display:none" onchange="importSVG(event)">

                <!-- Add to toolbar -->
                <input type="file" id="svgFileInput" accept=".svg" style="display:none" onchange="importSVG(event)">
                <button onclick="document.getElementById('svgFileInput').click()">Import SVG</button>

        </div>

        <main id="iconGrid"></main>

        <div class="editor-panel" id="editorPanel" style="display:none;">
                <label>Edit Icon SVG:</label>
                <textarea id="iconEditor"></textarea>
                <button onclick="saveIcon()">Save</button>
                <button onclick="deleteIcon()">Delete</button>
                <button onclick="closeEditor()">Close</button>
        </div>

        <svg id="iconSet" style="display:none;"></svg>
        <script>
                function importSVG(event) {
                        const file = event.target.files[0];
                        if (!file) return;

                        const reader = new FileReader();
                        reader.onload = e => {
                                const parser = new DOMParser();
                                const doc = parser.parseFromString(e.target.result, "image/svg+xml");

                                // Extract <symbol> elements
                                const symbols = doc.querySelectorAll("symbol");
                                symbols.forEach(sym => {
                                        const id = sym.id || `icon-${Date.now()}`;
                                        const svgContent = sym.innerHTML;
                                        if (!sampleIcons.find(i => i.id === id)) {
                                                sampleIcons.push({ id, svg: svgContent });
                                        }
                                });

                                // Fallback: if no <symbol>, use top-level <path> or all children
                                if (symbols.length === 0) {
                                        const paths = doc.querySelectorAll("path");
                                        if (paths.length) {
                                                const combined = Array.from(paths).map(p => p.outerHTML).join("");
                                                const id = `icon-${Date.now()}`;
                                                sampleIcons.push({ id, svg: combined });
                                        }
                                }

                                renderGrid();
                        };
                        reader.readAsText(file);
                }
        </script>

        <script>
                const iconGrid = document.getElementById("iconGrid");
                const editorPanel = document.getElementById("editorPanel");
                const iconEditor = document.getElementById("iconEditor");
                const iconSet = document.getElementById("iconSet");
                let selectedIconId = null;
                // Sample icons
                const sampleIcons = [{
                        id: "home",
                        svg: `<path d="M3 11.2L12 4l9 7.2v7.8A1 1 0 0 1 20 20H4a1 1 0 0 1-1-1v-7.8Z"/><path d="M9 20v-6a1 1 0 0 1 1-1h4a1 1 0 0 1 1 1v6"/>`
                },
                {
                        id: "star",
                        svg: `<path d="M12 4 14.2 8.5l5 .7-3.6 3.6.9 5.1-4.5-2.4-4.5 2.4.9-5.1-3.6-3.6 5-.7L12 4Z"/>`
                }
                ];

                function renderGrid() {
                        iconGrid.innerHTML = "";
                        iconSet.innerHTML = "";
                        sampleIcons.forEach(icon => {
                                // Add to sprite
                                const symbol = document.createElementNS("http://www.w3.org/2000/svg", "symbol");
                                symbol.id = icon.id;
                                symbol.innerHTML = icon.svg;
                                iconSet.appendChild(symbol);
                                // Add to grid
                                const div = document.createElement("div");
                                div.className = "icon-item";
                                div.innerHTML = `<svg><use href="#${icon.id}"></use></svg><div class="icon-name">${icon.id}</div>`;
                                div.onclick = () => editIcon(icon.id);
                                iconGrid.appendChild(div);
                        });
                }

                function addIcon() {
                        const id = prompt("Enter new icon ID:");
                        if (!id) return;
                        sampleIcons.push({
                                id,
                                svg: `<path d="M5 5h14v14H5z"/>`
                        });
                        renderGrid();
                        editIcon(id);
                }

                function editIcon(id) {
                        selectedIconId = id;
                        const icon = sampleIcons.find(i => i.id === id);
                        iconEditor.value = icon.svg;
                        editorPanel.style.display = "flex";
                }

                function saveIcon() {
                        if (!selectedIconId) return;
                        const icon = sampleIcons.find(i => i.id === selectedIconId);
                        icon.svg = iconEditor.value;
                        renderGrid();
                }

                function deleteIcon() {
                        if (!selectedIconId) return;
                        const idx = sampleIcons.findIndex(i => i.id === selectedIconId);
                        if (idx !== -1) sampleIcons.splice(idx, 1);
                        selectedIconId = null;
                        editorPanel.style.display = "none";
                        renderGrid();
                }

                function closeEditor() {
                        editorPanel.style.display = "none";
                        selectedIconId = null;
                }

                function downloadAll() {
                        const svgContent = `<svg xmlns="http://www.w3.org/2000/svg">${sampleIcons.map(i => `<symbol id="${i.id}">${i.svg}</symbol>`).join("")}</svg>`;
                        const blob = new Blob([svgContent], {
                                type: "image/svg+xml"
                        });
                        const a = document.createElement("a");
                        a.href = URL.createObjectURL(blob);
                        a.download = "icons.svg";
                        a.click();
                        URL.revokeObjectURL(a.href);
                }
                renderGrid();
        </script>

</body>

</html>